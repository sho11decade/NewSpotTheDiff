{% extends "base.html" %}
{% block title %}結果 - 間違い探し自動生成{% endblock %}

{% block content %}
<div class="card">
    <h2>間違い探し完成!</h2>

    <div class="result-info" id="resultInfo" hidden>
        <span class="badge" id="difficultyBadge"></span>
        <span class="badge badge--outline" id="countBadge"></span>
        <span class="badge badge--outline" id="timeBadge"></span>
    </div>

    <div class="comparison" id="comparison">
        <div class="comparison__panel">
            <h3>オリジナル</h3>
            <img id="originalImage" class="comparison__image" alt="オリジナル画像">
        </div>
        <div class="comparison__panel">
            <h3>間違い探し</h3>
            <img id="modifiedImage" class="comparison__image" alt="間違い探し画像">
        </div>
    </div>

    <div class="result-actions">
        <button class="btn btn--primary" id="downloadOriginal">オリジナルをDL</button>
        <button class="btn btn--primary" id="downloadModified">間違い探しをDL</button>
        <button class="btn btn--primary" id="downloadA4Layout">A4レイアウトをDL</button>
        <button class="btn btn--primary" id="downloadAnswerImage">答え画像をDL</button>
        <button class="btn btn--secondary" id="toggleAnswers">答えを見る</button>
        <button class="btn btn--secondary" id="toggleA4View">A4表示に切替</button>
        <a href="/" class="btn btn--secondary">新しい画像で作成</a>
    </div>

    <div id="a4Section" class="a4-section" hidden>
        <h3>A4横サイズレイアウト</h3>
        <div class="text-center mt-20">
            <img id="a4LayoutImage" class="a4-image" alt="A4レイアウト">
        </div>
        <div class="text-center mt-10">
            <button class="btn btn--primary" id="downloadA4WithAnswers">A4答え付きをDL</button>
        </div>
    </div>

    <div id="answersSection" class="answers" hidden>
        <h3>答え（変更箇所）</h3>
        <ul id="answersList"></ul>
        <div class="comparison mt-20">
            <div class="comparison__panel">
                <h4>元画像（答え表示）</h4>
                <img id="originalWithAnswers" class="comparison__image" alt="答え付き元画像">
            </div>
            <div class="comparison__panel">
                <h4>間違い探し（答え表示）</h4>
                <img id="modifiedWithAnswers" class="comparison__image" alt="答え付き間違い探し">
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script nonce="{{ csp_nonce() }}">
    const JOB_ID = "{{ job_id }}";
</script>
<script src="{{ url_for('static', filename='js/result.js') }}"></script>
{% endblock %}
